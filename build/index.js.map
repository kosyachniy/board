{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./canvas/canvas-designer-widget.js","webpack:///./index.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,OAAO;AAChD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA,gC;;;;;;;;;;;AC3OA,qBAAqB,mBAAO,CAAC,8EAAoC;AACjE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI,Q","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","// _______________\n// Canvas-Designer\n\n// Open-Sourced: https://github.com/muaz-khan/Canvas-Designer\n\n// --------------------------------------------------\n// Muaz Khan     - www.MuazKhan.com\n// MIT License   - www.WebRTC-Experiment.com/licence\n// --------------------------------------------------\n\nfunction CanvasDesigner() {\n    var designer = this;\n    designer.iframe = null;\n\n    var tools = {\n        line: true,\n        arrow: true,\n        pencil: true,\n        dragSingle: true,\n        dragMultiple: true,\n        eraser: true,\n        rectangle: true,\n        arc: true,\n        bezier: true,\n        quadratic: true,\n        text: true,\n        image: true,\n        pdf: true,\n        marker: true,\n        zoom: true,\n        lineWidth: true,\n        colorsPicker: true,\n        extraOptions: true,\n        code: true\n    };\n\n    designer.icons = {\n        line: null,\n        arrow: null,\n        pencil: null,\n        dragSingle: null,\n        dragMultiple: null,\n        eraser: null,\n        rectangle: null,\n        arc: null,\n        bezier: null,\n        quadratic: null,\n        text: null,\n        image: null,\n        pdf: null,\n        pdf_next: null,\n        pdf_prev: null,\n        pdf_close: null,\n        marker: null,\n        zoom: null,\n        lineWidth: null,\n        colorsPicker: null,\n        extraOptions: null,\n        code: null\n    };\n\n    var selectedIcon = 'pencil';\n\n    function syncData(data) {\n        if (!designer.iframe) return;\n\n        designer.postMessage({\n            canvasDesignerSyncData: data\n        });\n    }\n\n    var syncDataListener = function(data) {};\n    var dataURLListener = function(dataURL) {};\n    var captureStreamCallback = function() {};\n\n    function onMessage(event) {\n        if (!event.data || event.data.uid !== designer.uid) return;\n\n        if(!!event.data.sdp) {\n            webrtcHandler.createAnswer(event.data, function(response) {\n                if(response.sdp) {\n                    designer.postMessage(response);\n                    return;\n                }\n\n                captureStreamCallback(response.stream);\n            });\n            return;\n        }\n\n        if (!!event.data.canvasDesignerSyncData) {\n            designer.pointsLength = event.data.canvasDesignerSyncData.points.length;\n            syncDataListener(event.data.canvasDesignerSyncData);\n            return;\n        }\n\n        if (!!event.data.dataURL) {\n            dataURLListener(event.data.dataURL);\n            return;\n        }\n    }\n\n    function getRandomString() {\n        if (window.crypto && window.crypto.getRandomValues && navigator.userAgent.indexOf('Safari') === -1) {\n            var a = window.crypto.getRandomValues(new Uint32Array(3)),\n                token = '';\n            for (var i = 0, l = a.length; i < l; i++) {\n                token += a[i].toString(36);\n            }\n            return token;\n        } else {\n            return (Math.random() * new Date().getTime()).toString(36).replace(/\\./g, '');\n        }\n    }\n\n    designer.uid = getRandomString();\n\n    designer.appendTo = function(parentNode, callback) {\n        callback = callback || function() {};\n\n        designer.iframe = document.createElement('iframe');\n\n        // designer load callback\n        designer.iframe.onload = function() {\n            callback();\n            callback = null;\n        };\n\n        designer.iframe.src = designer.widgetHtmlURL + '?widgetJsURL=' + designer.widgetJsURL + '&tools=' + JSON.stringify(tools) + '&selectedIcon=' + selectedIcon + '&icons=' + JSON.stringify(designer.icons);\n        designer.iframe.style.width = '100%';\n        designer.iframe.style.height = '100%';\n        designer.iframe.style.border = 0;\n\n        window.removeEventListener('message', onMessage);\n        window.addEventListener('message', onMessage, false);\n\n        parentNode.appendChild(designer.iframe);\n    };\n\n    designer.destroy = function() {\n        if (designer.iframe) {\n            designer.iframe.parentNode.removeChild(designer.iframe);\n            designer.iframe = null;\n        }\n        window.removeEventListener('message', onMessage);\n    };\n\n    designer.addSyncListener = function(callback) {\n        syncDataListener = callback;\n    };\n\n    designer.syncData = syncData;\n\n    designer.setTools = function(_tools) {\n        tools = _tools;\n    };\n\n    designer.setSelected = function(icon) {\n        if (typeof tools[icon] !== 'undefined') {\n            selectedIcon = icon;\n        }\n    };\n\n    designer.toDataURL = function(format, callback) {\n        dataURLListener = callback;\n\n        if (!designer.iframe) return;\n        designer.postMessage({\n            genDataURL: true,\n            format: format\n        });\n    };\n\n    designer.sync = function() {\n        if (!designer.iframe) return;\n        designer.postMessage({\n            syncPoints: true\n        });\n    };\n\n    designer.pointsLength = 0;\n\n    designer.undo = function(index) {\n        if (!designer.iframe) return;\n\n        if(typeof index === 'string' && tools[index]) {\n            designer.postMessage({\n                undo: true,\n                tool: index\n            });\n            return;\n        }\n\n        designer.postMessage({\n            undo: true,\n            index: index || designer.pointsLength - 1 || -1\n        });\n    };\n\n    designer.postMessage = function(message) {\n        if (!designer.iframe) return;\n\n        message.uid = designer.uid;\n        designer.iframe.contentWindow.postMessage(message, '*');\n    };\n\n    designer.captureStream = function(callback) {\n        if (!designer.iframe) return;\n\n        captureStreamCallback = callback;\n        designer.postMessage({\n            captureStream: true\n        });\n    };\n\n    designer.clearCanvas = function () {\n        if (!designer.iframe) return;\n\n        designer.postMessage({\n            clearCanvas: true\n        });\n    };\n\n    designer.renderStream = function() {\n        if (!designer.iframe) return;\n\n        designer.postMessage({\n            renderStream: true\n        });\n    };\n\n    designer.widgetHtmlURL = 'widget.html';\n    designer.widgetJsURL = 'widget.min.js';\n}\n\nmodule.exports = CanvasDesigner;","var CanvasDesigner = require('./canvas/canvas-designer-widget.js');\n// const designer = new window.CanvasDesigner();\nconst designer = new CanvasDesigner();\n\n// установка параметров\ndesigner.setSelected('pencil');\ndesigner.setTools({\n\tpencil: true,\n\teraser: true,\n\tundo: true,\n});\ndesigner.icons = {\n\tpencil: '/img/pencil.png',\n\teraser: '/img/eraser.png',\n\tundo: '/img/undo.png',\n};\n\n// установка файлов\ndesigner.widgetHtmlURL = '/canvas/widget.html';\ndesigner.widgetJsURL = '/canvas/widget.min.js';\n\nmodule.exports = designer;\n\n// // отслеживание изменений\n// designer.addSyncListener((data) => {\n// \tconsole.log('!board_send', data);\n// \t// отправка изменений\n// \tsocketIo.emit('board_send', {\n// \t\tspace: path.room,\n// \t\tdata,\n// \t});\n// });\n\n// // ожидание изменений\n// socketIo.on('board_get', (mes) => {\n// \tconsole.log('!board_get', mes);\n// \t// если нужная комната\n// \tif (mes.space === path.room) {\n// \t\t// внедрение изменений\n// \t\tdesigner.syncData(mes.data);\n// \t}\n// });\n\n// // прикрепление к дом дереву\n// const boardBlock = document.getElementById('board');\n// designer.appendTo(boardBlock);\n\n// // включение синхронизации\n// setTimeout(() => {\n// \tdesigner.sync();\n// }, 3000);"],"sourceRoot":""}